"use strict";!function(){var a={csrfHash:"",csrfToken:"",eventListenersLoaded:!1,initialLoadComplete:!1,loadProcessRunning:!1,initialize:function(){t(),this.getProjectListData()},getProjectListData:function(){var a=this,r=jQuery("table#projectListResults");this.initialLoadComplete||o("<i class='fas fa-spinner fa-spin'></i> &nbsp;&nbsp; Loading Projects..","info"),n(),jQuery.ajax({type:"GET",url:"ProjectFinderJS/getProjectListData",data:{[a.csrfToken]:a.csrfHash},dataType:"json",cache:!1,complete:function(t){a.initialLoadComplete=!0,void 0!==t.responseJSON.data.token&&(a.csrfHash=t.responseJSON.data.token)},success:function(t){if(t.error)return o("<i class='fa fa-exclamation-triangle'></i> &nbsp;&nbsp; Error: "+t.error_msg,"error",!0),!1;t.data.project_data&&e(t.data.project_data),t.data.last_updated&&s(t.data.last_updated)},error:function(t,a,e){r.find("tbody").html("<tr><td colspan='2' class='empty-table'>No Results</td></tr>"),console.log(t,a,e)}})},getProjectListDetail:function(t){if(!t)return console.log("Missing repository id:",t),!1;var a=this,e=jQuery("div#project_detail_modal"),r=e.find("div.modal-body"),s=(e.find("div.modal-header span.modal-title"),"");jQuery.ajax({type:"GET",url:"ProjectFinderJS/getProjectListDetail",data:{repo_id:t,[a.csrfToken]:a.csrfHash},dataType:"json",cache:!1,beforeSend:function(){r.html("<div class='modal_overlay' style='display: block;'><i class='fas fa-spinner fa-spin'></i></div>"),e.modal("show")},complete:function(t){void 0!==t.responseJSON.data.token&&(a.csrfHash=t.responseJSON.data.token)},success:function(t){if(n(),t.error)return o("<i class='fa fa-exclamation-triangle'></i> &nbsp;&nbsp; Error: "+t.error_msg,"error",!0),!1;t.data.project_data&&(s+="<table class='table table-bordered'><tbody>",s+="<tr><td class='noWrap'>Repository ID</td><td>"+t.data.project_data.repository_id+"</td></tr>",s+="<tr><td class='noWrap'>Name</td><td>"+t.data.project_data.name+"</td></tr>",s+="<tr><td class='noWrap'>Description</td><td>"+(t.data.project_data.description||"[None]")+"</td></tr>",s+="<tr><td class='noWrap'>Link to Project</td><td><a target='_blank' href='"+t.data.project_data.html_url+"'>"+t.data.project_data.html_url+"</a></td></tr>",s+="<tr><td class='noWrap'>Stargazer Count</td><td>"+d(t.data.project_data.stargazers_count)+"</td></tr>",s+="<tr><td class='noWrap'>Date Created</td><td>"+t.data.project_data.created_at+"</td></tr>",s+="<tr><td class='noWrap'>Last Push Date</td><td>"+t.data.project_data.pushed_at+"</td></tr>",s+="</tbody></table>",r.html(s))},error:function(t,a,e){console.log(t,a,e),r.html("<div class='modal_overlay' style='display: block;'><i class='fa fa-exclamation-triangle'></i> &nbsp;&nbsp; Whoops.. an unexpected error has occurred.</div>")}})},loadGitHubProjects:function(){var a=this;if(this.loadProcessRunning)return o("<i class='fa fa-exclamation-triangle'></i> &nbsp;&nbsp; Processing is already running. Try again momentarily.","error"),!1;this.loadProcessRunning=!0,jQuery.ajax({type:"POST",url:"ProjectFinderJS/loadGitHubProjects",data:{[a.csrfToken]:a.csrfHash},dataType:"json",cache:!1,beforeSend:function(){o("<i class='fas fa-spinner fa-spin'></i> &nbsp;&nbsp; Working.. This may take a few moments.","info")},complete:function(t){a.loadProcessRunning=!1,void 0!==t.responseJSON.data.token&&(a.csrfHash=t.responseJSON.data.token)},success:function(t){if(n(),t.error)return o("<i class='fa fa-exclamation-triangle'></i> &nbsp;&nbsp; Error: "+t.error_msg,"error",!0),console.log("results: ",t),!1;t.data.success_msg&&o("<i class='fa fa-check'></i> &nbsp;&nbsp; "+t.data.success_msg,"success",!0),t.data.project_data&&e(t.data.project_data),t.data.last_updated&&s(t.data.last_updated)},error:function(t,a,e){console.log(t,a,e),o("<i class='fa fa-exclamation-triangle'></i> &nbsp;&nbsp; Whoops.. an unexpected error has occurred.","error",!0)}})}},t=function(){if(a.eventListenersLoaded)return!1;jQuery("div#projectListContainer table#projectListResults").on("click","tbody tr",function(){var t=jQuery(this).attr("data-repo-id");a.getProjectListDetail(t)}),jQuery("div#projectListContainer span#launch_update_request").click(function(){a.loadGitHubProjects()}),a.eventListenersLoaded=!0},e=function(t){if(!t||!t.length)return!1;for(var a=jQuery("table#projectListResults"),e="",r=0,r=0;r<t.length;r++)e+="<tr data-repo-id='"+t[r].repository_id+"'>",e+="<td>"+t[r].name+"</td>",e+="<td>"+d(t[r].stargazers_count)+"</td>",e+="</tr>";i.emptyTable(a),i.destroy(a),a.find("tbody").html(e),i.activate(a)},s=function(t){if(!t)return!1;jQuery("div#projectListContainer span#last_update_timestamp").html("Last Updated: "+t).show()},o=function(t,a,e){if(!t)return!1;var r,s=jQuery("div#projectListContainer div#info-msg-container"),o="";if(a)switch(a){case"error":o="alert-danger";break;case"success":o="alert-success";break;case"info":default:o="alert-info"}!0===e&&(t+="<button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span></button>"),r="<div class='alert alert-dismissible "+o+"' role='alert'>"+t+"</div>",s.html(r).show()},n=function(){jQuery("div#projectListContainer div#info-msg-container").html("").hide()},i={activate:function(t){if(!t.length)return!1;try{t.dataTable({iDisplayLength:50,autoWidth:!1,aaSorting:[],language:{searchPlaceholder:"Filter Results",search:"",emptyTable:"No results",infoEmpty:"",lengthMenu:"Display _MENU_"}})}catch(t){console.log(t)}},destroy:function(t){if(!t.length)return!1;t.DataTable().clear().destroy()},emptyTable:function(t){if(!t.length)return!1;t.find("tbody").html("")}},d=function(t){return t&&t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};window.ProjectFinder=a}();